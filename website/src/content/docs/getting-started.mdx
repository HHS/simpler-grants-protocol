---
title: Getting started
description: Get started with the CommonGrants protocol.
---

import { FileTree, Steps } from "@astrojs/starlight/components";

Welcome to the CommonGrants protocol documentation. This guide will help you get started with understanding and implementing the protocol.

## What is CommonGrants?

CommonGrants is a protocol designed to standardize how data about funding opportunities, applications, and awards is shared across the grant ecosystem.

The CommonGrants protocol is built on top of [TypeSpec](https://typespec.com/), a language for describing APIs that compiles to OpenAPI, JSON Schema, and other formats. To simplify the process of adopting this protocol, CommonGrants has published both:

- A TypeSpec library [`@common-grants/core`](https://www.npmjs.com/package/@common-grants/core) with a default set of models and routes
- A CLI tool [`@common-grants/cli`](https://www.npmjs.com/package/@common-grants/cli) to help you define and validate your API implementation

## Quickstart

The following tutorial will walk you through:

- Creating a new CommonGrants API specification using TypeSpec
- Compiling your project to OpenAPI and previewing it with Swagger
- Extending the base CommonGrants spec to include a custom field
- Viewing this new field in the OpenAPI docs

### Install the CLI

Install the CommonGrants CLI globally.

```bash
npm install @common-grants/cli -g
```

### Create a new project

Create a new project using the quickstart template.

```bash
cg init --template quickstart
```

This will create a new project in the current directory with the following files:

<FileTree>

- main.tsp # Defines the API service
- routes.tsp # Defines the API routes
- tspconfig.yaml # Configures TypeSpec emitters (e.g. OpenAPI)
- package.json # Manages project dependencies
- .gitignore # Ignores files from the project
- README.md # The project README

</FileTree>

### Install the project dependencies

```bash
npm install
```

This will install the following dependencies:

- `@common-grants/core` - The CommonGrants TypeSpec library, which includes a default set of models and routes
- `@typespec/compiler` - The TypeSpec compiler, which compiles the TypeSpec API definition into an OpenAPI specification
- `@typespec/openapi3` - The OpenAPI emitter for TypeSpec, which emits the API specification in OpenAPI format
- `@typespec/json-schema` - The JSON Schema emitter for TypeSpec, which emits the API models in JSON Schema format

### Compile to an OpenAPI specification

```bash
cg compile main.tsp
```

This will create a `tsp-output` directory with the following files compiled from `main.tsp`:

<FileTree>

- `tsp-output/`
  - `@typespec/`
    - `openapi3/` Auto-generated by the OpenAPI emitter
      - `openapi.CommonGrants.yaml` The base CommonGrants API spec
      - `openapi.Quickstart.yaml` The quickstart API spec
    - `json-schema/` Auto-generated by the JSON Schema emitter
      - `CustomEnumValue.yaml`
      - `Opportunity.yaml`
      - ...

</FileTree>

### Preview the OpenAPI specification

Preview the OpenAPI docs for the quickstart template.

```bash
cg preview tsp-output/@typespec/openapi3/openapi.Quickstart.yaml
```

This should start a local server that serves the OpenAPI specification using Swagger UI. View your API specification at http://localhost:3000.

### Add a custom field

Create a new file called `models.tsp` and with the following code:

```tsp title=models.tsp highlight={10-15}
import "@common-grants/core";

// Allows us to use models defined in the specification library
// without prefixing each model with `CommonGrants.Models.`
using CommonGrants.Models;

namespace Quickstart.Models;

model Agency extends CustomField {
  name: "Agency";
  type: CustomFieldType.string;
  value: string;
  description: "The agency managing the funding opportunity.";
}

// Create a custom Opportunity type using the template
model CustomOpportunity extends Opportunity.OpportunityBase {
  @example(
    #{
        agency: #{
            name: "Agency",
            type: CustomFieldType.string,
            value: "Department of Energy",
            description: "The agency managing the funding opportunity."
        }
    }
  )
  customFields: {
    agency: Agency;
  };
}
```

There's a lot happening here, so let's break it down section by section.

<Steps>

1. Import the CommonGrants TypeSpec library.
   ```tsp
   import "@common-grants/core";
   ```
2. Make the CommonGrants models available in the current namespace.

   ```tsp
   using CommonGrants.Models;
   ```

   Without this, you would have to prefix each model with `CommonGrants.Models`. For example `CommonGrants.Models.CustomField`.

3. Declare a namespace for the current file.
   ```tsp
   namespace Quickstart.Models;
   ```
4. Define a custom field by extending the `CustomField` model.

   ```tsp
   model Agency extends CustomField {
     name: "Agency";
     type: CustomFieldType.string;
     value: string;
     description: "The agency managing the funding opportunity.";
   }
   ```

   The `Agency` model defines literal values for the field's `name`, `type`, and `description` metadata properties, and requires the `value` property to be a string.

5. Extend the `OpportunityBase` model to include this custom field.
   ```tsp
   model CustomOpportunity extends Opportunity.OpportunityBase {
     // Example omitted for brevity
     customFields: {
       agency: Agency;
     };
   }
   ```
   It also provides an example of the updated `customFields` property, which will be displayed in the OpenAPI docs.
   ```tsp {2-11}
   model CustomOpportunity extends Opportunity.OpportunityBase {
    @example(
        #{
            agency: #{
                name: "Agency",
                type: CustomFieldType.string,
                value: "Department of Energy",
                description: "The agency managing the funding opportunity."
            }
        }
    )
    customFields: {
        agency: Agency;
        };
   }
   ```

</Steps>

### Update the default routes

Update the `routes.tsp` file and make the following changes:

- Import the `models.tsp` file to expose the `CustomOpportunity` model.
- Update the routes to use the `CustomOpportunity` model.

```tsp title=routes.tsp ins={2,13,14} del={11,12}
import "@common-grants/core";
import "./models.tsp";

using TypeSpec.Http;

@tag("Opportunities")
@route("/opportunities")
namespace Quickstart.Routes {
  alias OpportunitiesRouter = CommonGrants.Routes.Opportunities;

  op list is OpportunitiesRouter.list;
  op read is OpportunitiesRouter.read;
  op list is OpportunitiesRouter.list<Models.CustomOpportunity>;
  op read is OpportunitiesRouter.read<Models.CustomOpportunity>;
}
```

There's also a lot happening here, so let's break it down section by section.

<Steps>

1. Import the `models.tsp` file to expose the `CustomOpportunity` model.

   ```tsp
   import "./models.tsp";
   ```

2. Define a namespace for the `OpportunitiesRouter`.

   ```tsp
   @tag("Opportunities")
   @route("/opportunities")
   namespace Quickstart.Routes {
     alias OpportunitiesRouter = CommonGrants.Routes.Opportunities;
     // operations omitted for brevity
   }
   ```

   This exposes the default `GET /opportunities` and `GET /opportunities/{id}` routes defined in the CommonGrants library and groups them under the `Opportunities` tag.

3. Update the default routes to use the `CustomOpportunity` model.

   ```tsp {6,7}
   @tag("Opportunities")
   @route("/opportunities")
   namespace Quickstart.Routes {
     alias OpportunitiesRouter = Opportunities;

     op list is OpportunitiesRouter.list<Models.CustomOpportunity>;
     op read is OpportunitiesRouter.read<Models.CustomOpportunity>;
   }
   ```

   This updates `GET /opportunities` and `GET /opportunities/{id}` to return our `CustomOpportunity` model instead of the default model from the CommonGrants library.

</Steps>

The update `routes.tsp` file should now look like this:

```tsp title=routes.tsp
import "@common-grants/core";
import "./models.tsp";

using TypeSpec.Http;

@tag("Opportunities")
@route("/opportunities")
namespace Quickstart.Routes {
  alias OpportunitiesRouter = CommonGrants.Routes.Opportunities;

  op list is OpportunitiesRouter.list<Models.CustomOpportunity>;
  op read is OpportunitiesRouter.read<Models.CustomOpportunity>;
}
```

### View your changes

```bash
cg compile main.tsp
cg preview tsp-output/@typespec/openapi3/openapi.Quickstart.yaml
```

This should start a local server that serves the OpenAPI specification using Swagger UI. View your API specification at http://localhost:3000.

## Next steps

Learn more about the CommonGrants protocol:

- [About CommonGrants](/simpler-grants-protocol/about/)
- [Specification](/simpler-grants-protocol/protocol/specification/)

Learn more about TypeSpec:

- [TypeSpec documentation](https://typespec.com/docs)
- [TypeSpec GitHub repository](https://github.com/microsoft/typespec)
